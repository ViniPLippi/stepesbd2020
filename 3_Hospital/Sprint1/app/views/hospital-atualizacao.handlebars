<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
  integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.13.4/jquery.mask.min.js"></script>
<br />
<a href="/Hospital/delete/{{hos.hos_id}}" class="float-right btn btn-danger" alt="Apagar hospital" title="Apagar hospital" data-toggle="modal" data-toggle="tooltip" data-placement="top" data-target="#mdDelete" >
  <i class="fa fa-trash mr-2"></i> Remover
</a>
<h3>
  <i class="fa fa-h-square" aria-hidden="true"></i>
  {{hos.hos_name}}
</h3>
<h5>Atualização de Cadastro</h5>
<hr>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.15/jquery.mask.js"></script>
<form action="/hospital/Update/{{hos.hos_id}}" method="post">

    <div class="row">
        <div class="col">
            <div class="form-group">
            <label for="inputNome">Nome</label>
            <input type="text" class="form-control" name="inputNome" placeholder="" maxlength="100" minlength="10" value="{{hos.hos_name}}" required>
            </div>
        </div>
        <div class="col">
            <div class="form-group">
            <label for="inputCorporate">Razão Social</label>
            <input type="text" class="form-control" name="inputCorporate" placeholder="" maxlength="100" minlength="10" value="{{hos.hos_corporate_name}}" required>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col">
            <div class="form-group">
            <label for="inputCNPJ">CNPJ (digite apenas números)</label>
            <input type="text" class="form-control cnpj" name="inputCNPJ" placeholder="99.999.999/9999-99" maxlength="18" minlength="18" value="{{hos.hos_cnpj}}" required>
            </div>
        </div>
        <div class="col">
            <div class="form-group">
            <label for="inputCNES">Código CNES</label>
            <input type="text" class="form-control" name="inputCNES" placeholder="9999999" maxlength="7" minlength="7" value="{{hos.hos_cnes_code}}" onkeypress="return /[0-9]/i.test(event.key)" required>
            </div>
        </div>
    </div>


    <div class="form-row">
            <label for="adresses">Endereço</label>
    </div>

    <div class="row">
        <div class="col">
            <div class="form-group">
            <input type="text" class="form-control" name="inputStreet" placeholder="Rua" maxlength="45" minlength="5" value="{{add.add_street}}" required>
            </div>
        </div>
        <div class="col">
            <div class="form-group">
            <input type="number" class="form-control" name="inputNumber" placeholder="Número" maxlength="5" minlength="1" value="{{add.add_number}}" required>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col">
            <div class="form-group">
            <input type="text" class="form-control" name="inputCity" placeholder="Cidade" maxlength="50" minlength="1" value="{{add.add_city}}" required>
            </div>
        </div>
        <div class="col">
            <div class="form-group">
            <input type="text" class="form-control" name="inputState" placeholder="Estado" maxlength="50" minlength="1" value="{{add.add_state}}" required>
            </div>
        </div>
        <div class="col">
            <div class="form-group">
            <input type="text" class="form-control" name="inputCountry" placeholder="País" maxlength="50" minlength="1" value="{{add.add_country}}" required>
            </div>
        </div>
    </div>    

     <div class="row">
        <div class="col-md-4">
            <div class="form-group">
            <input type="text" class="form-control" name="inputZipCode" placeholder="Código Postal" maxlength="20" minlength="1" value="{{add.add_zip_code}}" required>
            </div>
        </div>
    </div>

        <div class="form-row">
            <label for="adresses">Contato</label>
    </div>
    <div class="form-row ml-2">
     <table class="col-md-6" id="item_table">
       {{#each con}}
          <tr>
            <td>
              <select name="inputContactType" class="form-control inputContactType mb-2">
                <option value="{{con_type}}">{{con_type}}</option>
              </select>
            </td>
            <td>
              <input type="text" name="inputContactBox" class="form-control inputContactBox mb-2 ml-2" value="{{con_desc}}" required/>
            </td>
            <td>
              <button type="button" name="remove" class="btn btn-danger  remove mb-2 ml-4">
                <span class="fa fa-minus"></span>
              </button>
            </td>
          </tr>
        {{/each}}
        <tr>
          <tr>
         <td>
           Novos contatos:
         </td>
       </tr>
            <td>
                <select name="inputContactType" class="form-control inputContactType">
                    <option value="Telefone">Telefone</option>
                    <option value="E-mail">E-mail</option>
                    <option value="Fax">Fax</option>
                </select>
            </td>
            <td><input type="text" id="newContactBox" name="inputContactBox" class="form-control inputContactBox ml-2" /></td>
            <td>
                <button type="button" name="add" class="btn btn-success add ml-4">
                    <span class="fa fa-plus"></span>
                </button>
            </td>
        </tr>
     </table>
    </div>

    <br>

    <div class="form-row text-center">
        <button type="submit" class="btn btn-success mr-2">Salvar</button> 
        <a class=" btn btn-primary" href="/hospital/" role="button">Voltar</a>
    </div>
</form>


<!-- Modal Delete-->
<div class="modal fade bd-example-modal-lg" id="mdDelete" tabindex="-1" role="dialog" aria-labelledby="deleteModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="deleteModalLabel">Desativar</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        Deseja apagar o registro de
        <span id="info"> {{hos.hos_name}} </span>
        ?
      </div>
      <div class="modal-footer">
        <form action="/Hospital/delete/{{hos.hos_id}}" method="get">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
          <button type="submit" class="btn btn-danger">Apagar</button>
        </form>
      </div>
    </div>
  </div>
</div>


<script>
    $(document).ready(function(){

        var contactCount = {{{json count}}};

        $(document).on('click', '.add', function(){
            var html = '';
            html += '<tr>';
            html += '<td><select name="inputContactType" class="form-control inputContactType mt-2"><option value="Telefone">Telefone</option><option value="E-mail">E-mail</option><option value="Fax">Fax</option></select></td>';
            html += '<td><input type="text" name="inputContactBox" class="form-control inputContactBox mt-2 ml-2" /></td>';
            html += '<td><button type="button" name="remove" class="btn btn-danger  remove mt-2 ml-4"><span class="fa fa-minus"></span></button></td></tr>';
            $('#item_table').append(html);
            contactCount = contactCount + 1;
        });
        
        $(document).on('click', '.remove', function(){
            $(this).closest('tr').remove();
            contactCount = contactCount - 1;
            if(contactCount === 0){
              document.getElementById("newContactBox").required = true;
            }else{
              document.getElementById("newContactBox").required = false;
            }
        });
    });


    $('.cnpj').mask('99.999.999/9999-99', {reverse: true});
</script>
